{% extends "/base.twig" %}
{% import "macros/utils.twig" as utils %}

{% block title %}Profil{% endblock %}
{% block subtitle %}
	<a id="retour" href="/" ><i class="fa fa-home" aria-hidden="true"></i></a>
	{% include ('security/partials/_tools.twig') %}
{% endblock %}

{% block main %}
    <section id="profil_section">
        <div class="container">
            <div class="row">
                <div class="col-lg-10 col-lg-offset-1">

                    <div class="row">
                        <div class="col-lg-8">
                            <dl id="profilInfos" class="dl-horizontal">
                                <dt><strong>Nom:</strong></dt>
                                <dd>{{ user.first }}</dd>
                                <dt><strong>Prénom:</strong></dt>
                                <dd>{{ user.last }}</dd>
                                <dt><strong>Email:</strong></dt>
                                <dd>
                                    {{ user.email }}
                                    {% if user.validated_email is empty %}
                                        <p class="label label-default"><i class="fa fa-hourglass-half" aria-hidden="true"></i> Non-validée</p>
                                        {% if user.token == "expired"  %}
                                            <div><a class="btn btn-danger btn-sm" href="">Renvoyer l'e-mail de confirmation</a></div>
                                        {% else %}
                                            <p><em><small>Un mail de confirmation a déjà été envoyé! <br> Vérifier vos mails (notament les indésirables),<br> sinon contacter l'administrateur <a href="mailto:contact@jeremy-monlouis.fr">Jérémy MONLOUIS</a></small></em></p>
                                        {% endif %}
                                    {% else %}
                                        <span class="label label-info"><i class="fa fa-check" aria-hidden="true"></i> Validé</span>
                                    {% endif %}
                                </dd>
                                <dt><strong>Identifiant:</strong></dt>
                                <dd>{% if user.isUsername %}{{ user.username }}{% else %}<i class="fa fa-ban" aria-hidden="true"></i>{% endif %}</dd>
                                <dt><strong>Membre depuis:</strong></dt>
                                <dd>le {{ user.frenchCreationDate }}</dd>
                                <dt>Commentaires:</dt>
                                <dd>{{ commentsCount }} 
                                {% if commentsPendingCount > 0 %} <em>(dont {{ commentsPendingCount }} en attente de modération)</em>{% endif %}
                                </dd>
                            </dl>
                        </div>

                        <div class="col-lg-4">
							<div id="divOverview">
                                <img id="thumbnailOverview" src={% if user.picture is empty %}"/assets/img/profile.png"{% else %}{{ user.picture }}{% endif %} class="img-responsive" alt="{{ user.first }} {{ user.last }}">
                            </div>
                        </div>
                    </div>
                    {% if comments | length > 0 %}
                    <h3 id="commentPage">Commentaires</h3>
                    {% endif %}
                    {% for comment in comments %}
                        <div class="panel panel-{% if comment.moderate or session.user.role == "admin" %}default{% else %}danger{% endif %}">
                            <div class="panel-heading commentHeader">
                                <p>Le {{comment.frenchCreationDate }} dans <a href="/post/{{ comment.post.identifier }}#comment">{{ comment.post.title }}</a>  {% if not comment.moderate  and session.user.role != "admin" %}<strong>(Non Approuvé)</strong>{% endif %}</p>
                                <a href="/comment/{{comment.identifier }}" ><i class="fa fa-2x fa-edit" aria-hidden="true"></i></a>
                            </div>
                            <div class="panel-body">
                                <p>{{ comment.comment | nl2br }}</p>
                            </div>
                        </div>
                    {% endfor %}
                    {{ utils.pagination(nbPage,"#commentPage") }}
                </div>
            </div>
        </div>
    </section>

	
{% endblock %}
